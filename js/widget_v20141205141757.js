function reflow(){var b=document.body;b.style.zoom=b.style.zoom=="1"?"100%":"1"}function handleAqi(){if(typeof(weatherinfovar)=="object"){if(weatherinfovar.weatherinfo.aqiLevel){$("#aqi").html('<a href="/air-'+defaultCityID+'.htm" target="_blank">空气质量:<i class="i-lv'+weatherinfovar.weatherinfo.aqiLevel+'"></i></a>');if(enableSet){$__("dtWea").className="has-all";$("#dtWea").hide();$("#dtWea").show()}else{$__("dtWea").className="has-aqi"}}else{if(!enableSet){$__("dtWea").className="has-none"}$("#aqi").hide()}}reflow()}var colors={1:"000000",2:"FFFFFF",3:"C6C6C6",4:"B00C22",5:"D10F41",6:"F47837",7:"FBD008",8:"51B148",9:"00AFDB",10:"2E93D9",11:"005391"};var args=parseQueryStrToJson(location.search);var showStyle=args["s"]==""?1:(args["s"]>3?3:(args["s"]<1?1:args["s"]));var verticality=parseInt(args["v"],10);var iconSize=parseInt(args["t"])==1?1:0;var autoDetect=parseInt(args["a"])==0?0:1;var defaultCityID=args["c"]==""?54511:args["c"];var showDayNum=args["d"]==""?3:(args["d"]>5?5:(args["d"]<1?1:args["d"]));var enableSet=parseInt(args["e"])==0?0:1;var enableAqi=parseInt(args["q"])==0?0:1;var weatherClass=["weather"];var textIcon=parseInt(args["z"])==0?1:args["z"];if(location.href.indexOf("debug")>-1){debug=true}else{debug=false}if(showStyle==3&&textIcon!=1){enableSet=enableAqi=0}if(enableSet){$__("dtWea").className="has-switch"}else{$__("dtWea").className="has-none"}if(args["h"]){if(args["bd"]==0){$__("weather").style.height=args["h"]+"px"}else{if(args["bd"]==1){$__("weather").style.height=args["h"]-2+"px"}}}if(args["f"]!=""){if(args["f"] in colors){weatherClass.push("c-"+colors[args["f"]])}else{weatherClass.push("c-"+args["f"])}}if(args["k"]!=""&&args["bd"]=="1"){if(args["k"] in colors){weatherClass.push("bd-"+colors[args["k"]])}else{weatherClass.push("bd-"+args["k"])}}if(typeof(args["align"])!="undefined"){weatherClass.push("align-"+args["align"])}$__("weather").className=weatherClass.join(" ");var direction=verticality?"vertical":"cross";var picSize=iconSize?"big":"small";if(showStyle==3){if(textIcon!=1){$__("wea-dl").className="cross-simple-icon"}else{$__("wea-dl").className=direction+"-text";$__("city-weaset").className="city-weaset city-weaset-"+direction+"-text"}}else{$__("wea-dl").className=direction+"-"+picSize;$__("city-weaset").className="city-weaset city-weaset-"+direction;if(showDayNum==1){$__("city-weaset").className="city-weaset city-weaset-vertical"}if(verticality==2&&showStyle==2){$__("wea-dl").className="cross-big-2";$__("city-weaset").className="city-weaset city-weaset-cross";iconSize=1}}if(autoDetect){if((defaultCityID=getCookie("widget_dz_id"))!=null){loadJs("/t/7day_tq_js/"+defaultCityID+".js")}else{loadJs("/t/detect2013_plugin.php")}}else{if(enableSet&&!debug){if(getCookie("widget_dz_id")!=null){loadJs("/t/7day_tq_js/"+getCookie("widget_dz_id")+".js")}else{loadJs("/t/7day_tq_js/"+defaultCityID+".js")}}else{loadJs("/t/7day_tq_js/"+defaultCityID+".js")}}if(enableAqi&&showStyle!=3){$__("aqi").style.display="";loadJs("/t/shikuang/"+defaultCityID+".js?"+(new Date()).valueOf(),handleAqi)}else{$__("aqi").style.display="none"}if(enableSet){$__("switch").style.display="";$__("switch").onclick=function(){loadJs("/js/citySelectData.js",seedProvCityCountySelect("selectProvince","selectCity","selectCounty"));$__("wea-dl").style.display="none";$__("city-weaset").style.display="";dzValues=getCookie("widget_dz_cityValues");if(dzValues!=null&&dzValues.indexOf(",")>-1){arrDzValues=dzValues.split(",");if(arrDzValues.length!=3){return}$__("selectProvince").value=arrDzValues[0];$("#selectProvince").trigger("change");$__("selectCity").value=arrDzValues[0]+","+arrDzValues[1];$("#selectCity").trigger("change");$__("selectCounty").value=arrDzValues[2]}else{if(dzValues!=null&&dzValues.indexOf("_")>-1){arrDzValues=dzValues.split("_");provIndex=arrDzValues[0];cityRealId=arrDzValues[2].match(/\d+$/)[0];countyRealId=arrDzValues[2].match(/^\d+/)[0];$__("selectProvince").value=provIndex;$("#selectProvince").trigger("change");for(i in provqx[provIndex]){var myRegExp=new RegExp("-"+cityRealId);if(myRegExp.test(provqx[provIndex][i])){cityIndex=i}}if(cityIndex){$__("selectCity").value=provIndex+","+cityIndex;$("#selectCity").trigger("change");$__("selectCounty").value=countyRealId}}}}}else{$__("switch").style.display="none"}$__("dzbtn").onclick=function(){var countyId=$("#selectCounty").val();if(countyId!=""){setDefaultDzWea(countyId);location.reload()}};$__("ccbtn").onclick=function(){$__("city-weaset").style.display="none";$__("wea-dl").style.display="block"};function $__(_id){return document.getElementById(_id)}function setDefaultDzWea(id){setCookie("widget_dz_id",id,24*365);setCookie("widget_dz_cityValues",$__("selectCity").value+","+$__("selectCounty").value,24*365)}function weaCallBack(data){$__("city").innerHTML=data["city"];if(typeof(smallCityList)!="undefined"&&typeof(smallCityList[data["city"]])!="undefined"){data["city"]=smallCityList[data["city"]]}$__("city").innerHTML=data["city"];$__("city").href="/"+data["pinyin"]+"/"+data["id"]+".htm";var wea=$__("wea-items");if(typeof(data["dayType"])!="undefined"&&data["dayType"]=="15"){var dataType="15"}else{var dataType="7"}var moreWea='<a class="wea-more" target="_blank" href="/'+data["pinyin"]+"/"+data["id"]+'.htm" title="点击查看'+dataType+'天天气"><i></i></a>';var items=[];for(i=1;i<=showDayNum;i++){var day=data["day"+i];switch(day[1]){case"六":day[1]='<em class="green">周'+day[1]+"</em>";break;case"日":day[1]='<em class="red">周'+day[1]+"</em>";break;default:day[1]="周"+day[1];break}switch(i){case 1:day[5]="今天("+day[1]+")";break;case 2:day[5]="明天("+day[1]+")";break;case 3:day[5]="后天("+day[1]+")";break;default:var dtmp=day[5].split("月");day[5]=dtmp[1]+"("+day[1]+")";break}if(showStyle==3){var tmp=day[0].split("～");if(textIcon==1){items.push('<div class="item'+(i==showDayNum?" last":"")+'"><a href="/'+data["pinyin"]+"/"+data["id"]+'.htm" target="_blank"><span class="first">'+day[5]+'：</span><span class="second"><b class="temp"><em class="green">'+tmp[0]+'</em>～<em class="red">'+tmp[1]+'</em></b><b class="cloud">'+day[2]+'</b></span><span class="third">'+day[3]+"</span></a></div>")}else{if(textIcon==2){$("#wea-items").parent().attr("class","haswind");$("#dtWea").remove();var winds=day[3].split("风");var windLength=winds.length;items=['<div class="item">'+'<a title="" target="_blank" href="/'+data["pinyin"]+"/"+data["id"]+'.htm">'+'<span class="first">'+data["city"]+'<i class="w'+day[4]+' wdy_3d"></i></span>'+'<span class="second"><b class="temp"><em class="green">'+tmp[0]+'</em>～<em class="red">'+tmp[1]+"</em></b></span>"+'&nbsp;<span class="third">'+winds[0]+"风"+winds[windLength-1]+"</span>"+"</a>"+"</div>"];break}else{if(textIcon==3){$("#dtWea").remove();items=['<div class="item">'+'<a title="" target="_blank" href="/'+data["pinyin"]+"/"+data["id"]+'.htm">'+'<span class="first">'+data["city"]+'<i class="w'+day[4]+'"></i></span>'+'<span class="second"><b class="temp"><em class="green">'+tmp[0]+'</em>～<em class="red">'+tmp[1]+"</em></b></span>"+"</a>"+"</div>"];break}}}}else{if(showStyle==2&&verticality==2){items.push('<div class="item">'+'<a title="" target="_blank" href="/'+data["pinyin"]+"/"+data["id"]+'.htm">'+'<span class="first"><i class="w'+day[4]+'_l wdy_l_3d"></i>'+day[5].substr(0,1)+" "+day[2]+"</span>"+'<span class="second">'+day[0]+"</span>"+" </a>"+"</div>")}else{items.push('<div class="item'+(i==showDayNum?" last":"")+'"><a href="/'+data["pinyin"]+"/"+data["id"]+'.htm" target="_blank"><span class="first"><i class="w'+day[4]+(!iconSize?(showStyle==2?" wdy_3d":""):(showStyle==2?"_l wdy_l_3d":"_l"))+'"></i>'+day[5]+'</span><span class="second">'+day[0]+'</span><span class="third">'+day[2]+"</span></a></div>")}}}if(showStyle==3){wea.innerHTML=items.join("")+moreWea}else{wea.innerHTML=items.join("");$(moreWea).appendTo("#weaItemsWraper")}var links=$("#wea-dl").find("a");if(links.length>0){links.click(function(){if(!/\d+?.htm/.test($(this).attr("href"))||!document.referrer){return}match=document.referrer.match("([^./]+.[a-zA-Z]+)/");if(match&&match.length==2){allCount("cj_"+match[1])}})}};